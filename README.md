# Yadisk Link Viewer (Просмотр ссылок Яндекс.Диска)

Простое и быстрое веб-приложение на Django для просмотра и скачивания файлов по публичным ссылкам Яндекс.Диска без необходимости авторизации или установки дополнительного ПО.

## Описание

Данное веб-приложение предоставляет удобный интерфейс для взаимодействия с контентом, доступным по публичным ссылкам Яндекс.Диска (вида `https://disk.yandex.ru/d/xxxx` или `https://yadi.sk/d/xxxx`). Пользователи могут просматривать структуру папок, скачивать отдельные файлы или упаковывать несколько файлов в ZIP-архив.

Приложение использует асинхронные запросы к публичному REST API Яндекс.Диска для повышения производительности.

## Возможности

*   **Ввод ссылки:** Простой ввод публичного URL Яндекс.Диска.
*   **Просмотр содержимого:** Отображение списка файлов и папок с именами и размерами.
*   **Навигация по папкам:** Возможность переходить во вложенные папки и обратно с помощью "хлебных крошек".
*   **Предпросмотр изображений:** Отображение миниатюр для изображений и открытие полноразмерного превью в модальном окне.
*   **Фильтрация файлов:** Фильтрация списка по типу (Изображения, Документы, Архивы, Видео, Аудио, Прочее). Фильтры отображаются только для тех типов, которые присутствуют в текущей папке.
*   **Пагинация:** Разделение списка файлов на страницы (25, 50 или 100 элементов) для удобства работы с большими папками.
*   **Скачивание одного файла:** Прямой редирект на ссылку Яндекса для быстрой загрузки одиночного файла.
*   **Скачивание нескольких файлов (.zip):**
    *   Выбор нескольких файлов с помощью чекбоксов.
    *   Асинхронное получение ссылок и скачивание файлов с Яндекса во временные файлы на сервере.
    *   **Потоковая упаковка в ZIP-архив** (без сжатия для скорости - `zipfile.ZIP_STORED`) для минимизации потребления памяти сервера.
    *   Потоковая отправка ZIP-архива клиенту (`StreamingHttpResponse`).
    *   Автоматическая очистка временных файлов после отправки.
    *   Название архива формируется на основе имени публичной папки/файла.
*   **Асинхронность:** Использование `asyncio`, `aiohttp`, `aiofiles` для неблокирующих сетевых операций и файлового ввода/вывода.
*   **Кеширование:** Кеширование метаданных API Яндекса (с помощью Django Cache `LocMemCache`) для ускорения повторных запросов и снижения нагрузки.
*   **Современный интерфейс:** Чистый адаптивный дизайн с использованием CSS.

## Технологический стек

*   **Python**
*   **Django**
*   **aiohttp** (Асинхронный HTTP-клиент)
*   **aiofiles** (Асинхронная работа с файлами)
*   **zipfile** (Стандартная библиотека Python для ZIP)
*   **uvicorn** (ASGI-сервер)
*   **django-humanize** (Для форматирования размера файлов)
*   **whitenoise** (Для раздачи статики в production)
*   **HTML5, CSS3, JavaScript** (Фронтенд)

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/anpain/yadisk_viewer_project
    cd yadisk_viewer_project
    ```

2.  **Создайте и активируйте виртуальное окружение:**
    *   Убедитесь, что у вас установлена **рекомендуемая версия Python**.
    *   *(Windows)*
        ```bash
        python -m venv venv
        .\venv\Scripts\activate
        ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
    *(Примечание: `requirements.txt` включает все необходимые пакеты, включая `django`, `aiohttp`, `uvicorn`, `aiofiles`, `whitenoise`, `django-humanize` и их зависимости).*

4.  **Примените миграции Django** (необходимы для работы сессий):
    ```bash
    python manage.py migrate
    ```

5.  **(Опционально) Соберите статические файлы** (Обычно требуется для `whitenoise` в production, но может быть полезно и для dev):
    ```bash
    python manage.py collectstatic --noinput
    ```

6.  **Запустите ASGI-сервер (Uvicorn):**
    ```bash
    uvicorn yadisk_viewer.asgi:application --reload
    ```
    *(Флаг `--reload` автоматически перезапускает сервер при изменении кода, удобно для разработки).*

7.  **Откройте приложение в браузере:**
    Перейдите по адресу `http://127.0.0.1:8000` (или по адресу, указанному uvicorn).

## Использование

1.  Вставьте публичную ссылку Яндекс.Диска в поле ввода.
2.  Нажмите кнопку "Обзор".
3.  Просматривайте файлы и папки.
4.  Используйте фильтры для отображения нужных типов файлов.
5.  Нажмите "Скачать" рядом с файлом для загрузки одного файла.
6.  Отметьте несколько файлов чекбоксами и нажмите "Скачать выбранное (.zip)" для получения ZIP-архива.
7.  Кликайте на миниатюры изображений для просмотра полного размера во всплывающем окне (закрывается кликом вне изображения или клавишей Esc).

## Ограничения

*   Работает **только с публичными** ссылками Яндекс.Диска.
*   **Не требует** авторизации пользователя в Яндексе.
*   **Не работает** с приватными файлами пользователя.
*   Производительность скачивания ZIP зависит от скорости сети сервера, количества и размера файлов, а также ограничений API Яндекса.